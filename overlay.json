{
    "overlay": "1.0.0",
    "info": {
        "title": "Fix OpenAPI spec",
        "version": "1.0.1"
    },
    "actions": [
        {
            "target": "$.components.schemas.TranscriptionResponse.required",
            "remove": true
        },
        {
            "target": "$.components.schemas.TranscriptionResponse",
            "update": {
                "required": [
                    "model",
                    "text",
                    "usage"
                ]
            }
        },
        {
            "target": "$.components.schemas.EmbeddingResponse.allOf[1].properties.data.items",
            "remove": true
        },
        {
            "target": "$.components.schemas.TranscriptionResponse.properties.language.anyOf",
            "remove": true
        },
        {
            "target": "$.components.schemas.TranscriptionResponse.properties.language",
            "update": {
                "type": "string",
                "pattern": "^\\w{2}$",
                "title": "Language"
            }
        },
        {
            "target": "$.components.schemas.EmbeddingResponse.allOf[1].properties.data",
            "update": {
                "items": {
                    "$ref": "#/components/schemas/EmbeddingResponseData"
                }
            }
        },
        {
            "target": "$.components.schemas.UsageInfo.properties.prompt_audio_seconds",
            "update": {
                "type": "integer",
                "title": "Prompt Audio Seconds"
            }
        },
        {
            "target": "$.components.schemas.UsageInfo.properties.prompt_audio_seconds.anyOf",
            "remove": true
        },
        {
            "target": "$.components.schemas.UsageInfo.properties.prompt_audio_seconds.nullable",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.file.anyOf",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.file.default",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.file",
            "update": {
                "$ref": "#/components/schemas/File"
            }
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.file_url.anyOf",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.file_url.default",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.file_url",
            "update": {
                "type": "string",
                "format": "uri",
                "minLength": 1,
                "maxLength": 2083
            }
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.file_id.anyOf",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.file_id.default",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.file_id",
            "update": {
                "type": "string"
            }
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.language.anyOf",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.language.default",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.language",
            "update": {
                "type": "string",
                "pattern": "^\\w{2}$"
            }
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.temperature.anyOf",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.temperature.default",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequest.properties.temperature",
            "update": {
                "type": "number"
            }
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.file.anyOf",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.file.default",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.file",
            "update": {
                "$ref": "#/components/schemas/File"
            }
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.file_url.anyOf",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.file_url.default",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.file_url",
            "update": {
                "type": "string",
                "format": "uri",
                "minLength": 1,
                "maxLength": 2083
            }
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.file_id.anyOf",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.file_id.default",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.file_id",
            "update": {
                "type": "string"
            }
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.language.anyOf",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.language.default",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.language",
            "update": {
                "type": "string",
                "pattern": "^\\w{2}$"
            }
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.temperature.anyOf",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.temperature.default",
            "remove": true
        },
        {
            "target": "$.components.schemas.AudioTranscriptionRequestStream.properties.temperature",
            "update": {
                "type": "number"
            }
        },
        {
            "target": "$.components.schemas",
            "update": {
                "APIError": {
                    "type": "object",
                    "properties": {
                        "code": {
                            "type": "string",
                            "nullable": true,
                            "title": "Code"
                        },
                        "message": {
                            "type": "object",
                            "title": "Message",
                            "properties": {
                                "detail": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "ctx": {
                                                "type": "object",
                                                "description": "Context information related to the error (e.g., error details from an underlying library)."
                                            },
                                            "input": {
                                                "type": "object",
                                                "description": "The input parameters that caused the error."
                                            },
                                            "loc": {
                                                "type": "array",
                                                "items": {},
                                                "description": "Location of the error in the request data structure."
                                            },
                                            "msg": {
                                                "type": "string",
                                                "description": "The specific error message."
                                            },
                                            "type": {
                                                "type": "string",
                                                "description": "The type of the specific error (e.g., 'assertion_error')."
                                            }
                                        },
                                        "required": [
                                            "msg",
                                            "type"
                                        ]
                                    }
                                }
                            },
                            "required": [
                                "detail"
                            ]
                        },
                        "object": {
                            "type": "string",
                            "title": "Object",
                            "enum": [
                                "error"
                            ]
                        },
                        "param": {
                            "type": "string",
                            "nullable": true,
                            "title": "Param"
                        },
                        "type": {
                            "type": "string",
                            "title": "Type"
                        }
                    },
                    "required": [
                        "message",
                        "object",
                        "type"
                    ],
                    "title": "APIError"
                }
            }
        },
        {
            "target": "$.paths./v1/audio/transcriptions.post.responses",
            "update": {
                "400": {
                    "description": "Bad Request - Invalid model or request parameters",
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/APIError"
                            }
                        }
                    }
                },
                "422": {
                    "description": "Unprocessable Entity - Missing required parameters",
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/APIError"
                            }
                        }
                    }
                }
            }
        },
        {
            "target": "$.components.schemas.TranscriptionResponse.properties",
            "update": {
                "finish_reason": {
                    "type": "string",
                    "title": "Finish Reason"
                }
            }
        },
        {
            "target": "$.components.schemas.UsageInfo.properties",
            "update": {
                "num_cached_tokens": {
                    "type": "integer",
                    "title": "Num Cached Tokens",
                    "default": 0
                }
            }
        }
    ]
}